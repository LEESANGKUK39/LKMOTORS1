<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LKMOTORS ERP MASTER</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background: #f0f2f5; color: #1a202c; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ëª…ì„¸ì„œ ìŠ¤íƒ€ì¼ */
        .bill-container { background: white; padding: 50px; border: 1px solid #ddd; width: 210mm; margin: 0 auto; min-height: 297mm; box-shadow: 0 4px 20px rgba(0,0,0,0.08); position: relative; }
        .t-frame { width: 100%; border-collapse: collapse; border: 2px solid #333; margin-bottom: 15px; }
        .t-frame td, .t-frame th { border: 1px solid #333; padding: 10px; font-size: 13px; height: 40px; }
        .bg-label { background: #f8fafc; font-weight: 700; width: 15%; text-align: center; color: #334155; }
        .input-none { border: none; width: 100%; outline: none; background: transparent; font-weight: 500; }
        
        /* ê²Œì„ ì„¼í„° ìŠ¤íƒ€ì¼ */
        .game-panel { background: #1e293b; border-radius: 40px; padding: 40px; color: white; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        #mazeCanvas { background: #fff; border-radius: 15px; cursor: pointer; border: 8px solid #334155; }
        
        @media print { 
            .no-print { display: none !important; } 
            .bill-container { border: none; box-shadow: none; margin: 0; padding: 20px; width: 100%; }
            body { background: white; }
        }
    </style>
</head>
<body>

    <div id="auth-layer" class="fixed inset-0 bg-slate-900 flex items-center justify-center z-[100]">
        <div class="bg-white p-12 rounded-[50px] shadow-2xl w-full max-w-md">
            <h2 class="text-5xl font-black italic text-center mb-10 tracking-tighter text-slate-800 underline decoration-blue-500">LKMOTORS</h2>
            <div class="space-y-5">
                <input type="text" id="uid" placeholder="ADMIN ID" class="w-full p-5 border-2 rounded-2xl font-bold text-lg focus:border-blue-500 outline-none transition-all">
                <input type="password" id="upw" placeholder="PASSWORD" class="w-full p-5 border-2 rounded-2xl font-bold text-lg focus:border-blue-500 outline-none transition-all">
                <button onclick="login()" class="w-full py-6 bg-blue-600 text-white font-black rounded-3xl text-2xl shadow-xl hover:bg-blue-700 active:scale-95 transition-all">ì ‘ì†í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <div id="main-layer" class="hidden">
        <header class="no-print bg-white/80 backdrop-blur-md border-b sticky top-0 z-50 p-4">
            <div class="max-w-7xl mx-auto flex justify-between items-center">
                <div class="flex items-center gap-3 cursor-pointer" onclick="showT('t-repair')">
                    <div class="w-12 h-12 bg-slate-900 text-white rounded-2xl flex items-center justify-center font-black text-2xl">L</div>
                    <span class="font-black italic text-2xl tracking-tighter">LKMOTORS <span class="text-blue-600 text-sm">PRO ERP</span></span>
                </div>
                <nav class="flex gap-10 font-bold">
                    <button onclick="showT('t-repair')" class="hover:text-blue-600 transition">ì •ë¹„ ëª…ì„¸ì„œ</button>
                    <button onclick="showT('t-game')" class="text-blue-600 border-2 border-blue-600 px-4 py-1 rounded-full hover:bg-blue-600 hover:text-white transition">ğŸ® ê²Œì„ ì„¼í„°</button>
                </nav>
            </div>
        </header>

        <main class="max-w-7xl mx-auto p-6">
            
            <section id="t-repair" class="tab-content active">
                <div class="bill-container">
                    <h1 class="text-4xl font-black text-center mb-2 italic">ìë™ì°¨ ì ê²€ Â· ì •ë¹„ ëª…ì„¸ì„œ</h1>
                    <p class="text-center text-xs text-slate-400 mb-10">(ì†Œë¹„ì ë³´ê´€ìš©)</p>
                    
                    <table class="t-frame">
                        <tr>
                            <td class="bg-label">ìƒ í˜¸</td><td><input type="text" class="input-none font-bold" value="LKMOTORS (ì—˜ì¼€ì´ëª¨í„°ìŠ¤)"></td>
                            <td class="bg-label">ì‚¬ì—…ìë²ˆí˜¸</td><td><input type="text" class="input-none" value="000-00-00000"></td>
                        </tr>
                        <tr>
                            <td class="bg-label">ëŒ€ í‘œ ì</td><td><input type="text" class="input-none" value="ì‚¬ì¥ë‹˜"></td>
                            <td class="bg-label">ì „í™”ë²ˆí˜¸</td><td><input type="text" class="input-none" value="010-2727-2800"></td>
                        </tr>
                    </table>

                    <table class="t-frame">
                        <tr>
                            <td class="bg-label text-blue-600">ì°¨ëŸ‰ë²ˆí˜¸</td><td><input type="text" id="v-car" class="input-none font-black text-xl uppercase"></td>
                            <td class="bg-label">ì°¨ì£¼ì„±í•¨</td><td><input type="text" id="v-owner" class="input-none font-bold"></td>
                        </tr>
                        <tr>
                            <td class="bg-label">ì°¨ëŸ‰í˜•ì‹</td><td><input type="text" id="v-type" class="input-none" placeholder="ì°¨ëŸ‰ ëª¨ë¸ëª…"></td>
                            <td class="bg-label">ì°¨ëŒ€ë²ˆí˜¸</td><td><input type="text" id="v-vin" class="input-none font-mono" placeholder="VIN 17ìë¦¬"></td>
                        </tr>
                        <tr>
                            <td class="bg-label">ì£¼í–‰ê±°ë¦¬</td><td><input type="text" id="v-mile" class="input-none text-right font-bold" placeholder="0"> km</td>
                            <td class="bg-label">ì—°ë½ì²˜</td><td><input type="text" id="v-phone" class="input-none"></td>
                        </tr>
                    </table>

                    <table class="t-frame">
                        <tr class="text-center font-bold text-xs">
                            <td class="bg-label">ì…ê³  ë‚ ì§œ</td>
                            <td><input type="date" id="v-date-in" class="input-none text-center"></td>
                            <td class="bg-label">ì™„ë£Œ ë‚ ì§œ</td>
                            <td><input type="date" id="v-date-done" class="input-none text-center"></td>
                            <td class="bg-label">ì¶œê³  ë‚ ì§œ</td>
                            <td><input type="date" id="v-date-out" class="input-none text-center"></td>
                        </tr>
                    </table>

                    <table class="t-frame">
                        <thead class="bg-slate-800 text-white text-xs">
                            <tr>
                                <th class="p-2">ë¶€í’ˆëª… ë° ì •ë¹„ë‚´ìš©</th>
                                <th class="w-16">ìˆ˜ëŸ‰</th>
                                <th class="w-24">ë¶€í’ˆë¹„</th>
                                <th class="w-24">ê¸°ìˆ ë£Œ(ê³µì„)</th>
                                <th class="w-32">ì†Œê³„</th>
                            </tr>
                        </thead>
                        <tbody id="bill-items"></tbody>
                        <tfoot class="bg-slate-50 font-black">
                            <tr>
                                <td colspan="4" class="p-4 text-right">ì´ í•©ê³„ ê¸ˆì•¡ (ë¶€ê°€ê°€ì¹˜ì„¸ í¬í•¨)</td>
                                <td id="total-val" class="p-4 text-right text-2xl text-blue-600 italic">â‚© 0</td>
                            </tr>
                        </tfoot>
                    </table>

                    <div class="mt-20 flex justify-between items-end border-t-4 border-double border-slate-800 pt-10 px-5">
                        <div class="text-sm font-bold">
                            <p>ì •ë¹„ì±…ì„ì: (ì¸)</p>
                            <p class="mt-2 text-slate-400">ê·€í•˜ì˜ ì°¨ëŸ‰ì„ ì •ì„±ê» ì •ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
                        </div>
                        <div class="text-3xl font-black italic">
                            ë°œí–‰ì¼ì: <input type="date" id="v-bill-date" class="border-b-4 border-black outline-none bg-transparent w-56 text-center">
                        </div>
                    </div>
                </div>

                <div class="no-print mt-10 flex gap-5 max-w-[210mm] mx-auto">
                    <button onclick="saveToCloud()" class="flex-1 py-6 bg-slate-900 text-white font-black text-2xl rounded-[30px] shadow-2xl hover:bg-black transition-all">ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥</button>
                    <button onclick="window.print()" class="px-14 bg-slate-400 text-white font-black rounded-[30px] text-xl">ëª…ì„¸ì„œ ì¸ì‡„</button>
                </div>
            </section>

            <section id="t-game" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                    
                    <div class="game-panel text-center">
                        <div class="flex justify-between items-start mb-10">
                            <h3 class="text-3xl font-black italic">WORD PUZZLE</h3>
                            <div class="text-right">
                                <p id="p-level" class="text-blue-400 font-black text-xl uppercase">Level 1</p>
                                <p id="p-score" class="text-xs font-bold text-slate-400">Score: 0</p>
                            </div>
                        </div>
                        <div id="p-scrambled" class="text-6xl font-black tracking-widest bg-white/10 py-16 rounded-[40px] mb-10 shadow-inner">-----</div>
                        <input type="text" id="p-input" class="w-full p-6 bg-white/5 border-2 border-white/10 rounded-3xl text-center font-black text-3xl mb-6 focus:border-blue-500 outline-none transition-all" placeholder="ANSWER">
                        <div class="flex gap-4">
                            <button onclick="checkP()" class="flex-1 py-5 bg-blue-600 text-white font-black rounded-3xl text-2xl shadow-lg active:scale-95 transition">SUBMIT</button>
                            <button onclick="initP()" class="px-10 py-5 bg-white/10 text-white font-bold rounded-3xl">SKIP</button>
                        </div>
                    </div>

                    <div class="game-panel text-center">
                        <h3 class="text-3xl font-black italic mb-10 text-green-400">MAZE RUNNER</h3>
                        <div class="mb-5 flex justify-between px-4 text-xs font-bold text-slate-400 uppercase">
                            <span>Start: ğŸš—</span>
                            <span>Goal: ğŸš©</span>
                        </div>
                        <canvas id="mazeCanvas" width="300" height="300" class="mx-auto shadow-2xl"></canvas>
                        <div class="grid grid-cols-3 gap-4 w-56 mx-auto mt-10">
                            <div></div><button onmousedown="moveM('up')" class="w-16 h-16 bg-white/10 rounded-2xl font-black text-2xl hover:bg-green-500 transition">â–²</button><div></div>
                            <button onmousedown="moveM('left')" class="w-16 h-16 bg-white/10 rounded-2xl font-black text-2xl hover:bg-green-500 transition">â—€</button>
                            <button onmousedown="moveM('down')" class="w-16 h-16 bg-white/10 rounded-2xl font-black text-2xl hover:bg-green-500 transition">â–¼</button>
                            <button onmousedown="moveM('right')" class="w-16 h-16 bg-white/10 rounded-2xl font-black text-2xl hover:bg-green-500 transition">â–¶</button>
                        </div>
                        <button onclick="initM()" class="mt-10 text-slate-500 font-bold underline">REGENERATE MAZE</button>
                    </div>

                </div>
            </section>
        </main>
    </div>

    <script>
        // íŒŒì´ì–´ë² ì´ìŠ¤ ì´ˆê¸°í™”
        const firebaseConfig = {
            apiKey: "AIzaSyDhTPGNKNm38PSBdATs9lks0lYu52QrP3A",
            authDomain: "lkmotors-246f1.firebaseapp.com",
            databaseURL: "https://lkmotors-246f1-default-rtdb.firebaseio.com",
            projectId: "lkmotors-246f1",
            storageBucket: "lkmotors-246f1.firebasestorage.app",
            messagingSenderId: "389443224",
            appId: "1:389443224:web:c9b78c1afd3abc1c262aed"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ì¸ì¦ ë¡œì§
        function login() {
            const id = document.getElementById('uid').value;
            const pw = document.getElementById('upw').value;
            if(id === "sansay333" && pw === "aa272728") {
                document.getElementById('auth-layer').classList.add('hidden');
                document.getElementById('main-layer').classList.remove('hidden');
                initBill();
            } else { alert("ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."); }
        }

        // ëª…ì„¸ì„œ ì´ˆê¸°í™” (10ì¤„)
        function initBill() {
            const body = document.getElementById('bill-items');
            body.innerHTML = "";
            for(let i=0; i<10; i++) {
                body.innerHTML += `
                    <tr class="bill-row">
                        <td><input type="text" class="input-none i-nm"></td>
                        <td><input type="number" value="1" class="input-none text-center i-qt" oninput="calc()"></td>
                        <td><input type="number" class="input-none text-center i-pr" oninput="calc()"></td>
                        <td><input type="number" class="input-none text-center i-lb" oninput="calc()"></td>
                        <td class="text-right px-4 font-bold bg-slate-50 i-sum text-blue-600">0</td>
                    </tr>
                `;
            }
        }

        function calc() {
            let total = 0;
            document.querySelectorAll('.bill-row').forEach(row => {
                const qt = parseFloat(row.querySelector('.i-qt').value) || 0;
                const pr = parseFloat(row.querySelector('.i-pr').value) || 0;
                const lb = parseFloat(row.querySelector('.i-lb').value) || 0;
                const sum = (qt * pr) + lb;
                row.querySelector('.i-sum').innerText = sum.toLocaleString();
                total += sum;
            });
            document.getElementById('total-val').innerText = "â‚© " + total.toLocaleString();
        }

        function saveToCloud() {
            const car = document.getElementById('v-car').value.toUpperCase();
            if(!car) return alert("ì°¨ëŸ‰ë²ˆí˜¸ í•„ìˆ˜");
            const data = {
                car,
                owner: document.getElementById('v-owner').value,
                vin: document.getElementById('v-vin').value,
                date_in: document.getElementById('v-date-in').value,
                date_done: document.getElementById('v-date-done').value,
                date_out: document.getElementById('v-date-out').value,
                bill_date: document.getElementById('v-bill-date').value,
                total: document.getElementById('total-val').innerText
            };
            db.ref('bills/' + car).push(data).then(() => alert("ì €ì¥ ì™„ë£Œ"));
        }

        // íƒ­ ì „í™˜
        function showT(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 't-game') { initP(); initM(); }
        }

        // [ê²Œì„ 1: ë‹¨ì–´ í¼ì¦]
        const words = ["ENGINE", "BRAKE", "TIRE", "WHEEL", "BUMPER", "MIRROR", "WINDOW", "BATTERY", "PISTON", "CHASSIS", "SENSOR", "GEAR", "CLUTCH", "TURBO", "HYBRID"];
        let ans = "", lv = 1, score = 0;
        function initP() {
            ans = words[Math.floor(Math.random()*words.length)];
            let scrambled = ans.split('').sort(() => Math.random() - 0.5).join('');
            document.getElementById('p-scrambled').innerText = scrambled;
            document.getElementById('p-input').value = "";
            document.getElementById('p-level').innerText = "Level " + lv;
            document.getElementById('p-score').innerText = "Score: " + score;
        }
        function checkP() {
            if(document.getElementById('p-input').value.toUpperCase() === ans) {
                lv++; score += 100; alert("ì •ë‹µ! ë ˆë²¨ì—…!"); initP();
            } else { alert("ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!"); }
        }

        // [ê²Œì„ 2: ë¯¸ë¡œ ì°¾ê¸°]
        const canvas = document.getElementById('mazeCanvas');
        const ctx = canvas.getContext('2d');
        const mS = 15, mC = 20;
        let px = 0, py = 0, maze = [];
        function initM() {
            maze = Array(mS).fill().map(() => Array(mS).fill(1));
            for(let y=0; y<mS; y++) for(let x=0; x<mS; x++) if(Math.random() > 0.3) maze[y][x] = 0;
            maze[0][0] = 0; maze[mS-1][mS-1] = 0;
            px = 0; py = 0; drawM();
        }
        function drawM() {
            ctx.clearRect(0,0,300,300);
            for(let y=0; y<mS; y++) for(let x=0; x<mS; x++) if(maze[y][x]) { ctx.fillStyle="#1e293b"; ctx.fillRect(x*mC,y*mC,mC,mC); }
            ctx.font="14px Arial"; ctx.fillText("ğŸš©",(mS-1)*mC+2,(mS-1)*mC+15); ctx.fillText("ğŸš—",px*mC+2,py*mC+15);
        }
        function moveM(d) {
            let nx = px, ny = py;
            if(d==='up') ny--; if(d==='down') ny++; if(d==='left') nx--; if(d==='right') nx++;
            if(nx>=0 && nx<mS && ny>=0 && ny<mS && maze[ny][nx]===0) {
                px = nx; py = ny; drawM();
                if(px === mS-1 && py === mS-1) { alert("íƒˆì¶œ! ë‹¤ìŒ ë‹¨ê³„!"); initM(); }
            }
        }
    </script>
</body>
</html>
